<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ObowiƒÖzki domowe - Admin</title>
<style>
  body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f3f3f3; }
  header { background: #4caf50; color: white; padding: 20px; text-align: center; }
  #loginScreen { display: flex; flex-direction: column; justify-content: center; align-items: center; height: 80vh; }
  #loginScreen input, #loginScreen button { padding: 10px; margin: 5px; font-size: 16px; }
  main { padding: 20px; margin-left:0; transition: margin-left 0.3s; }
  /* Panele boczne */
  .sidePanel { position: fixed; top: 0; width: 250px; height: 100%; background: #fff; box-shadow: 2px 0 5px rgba(0,0,0,0.3); overflow-x: hidden; transition: transform 0.3s; z-index: 100; }
  #leftPanel { left: 0; transform: translateX(-100%); }
  #rightPanel { right: 0; transform: translateX(100%); }
  .panelButton { position: fixed; top: 20px; width: 40px; height: 40px; background: #4caf50; color: white; border: none; cursor: pointer; z-index: 101; display: flex; justify-content:center; align-items:center; font-size:20px; }
  #leftBtn { left: 0; transform: translateX(0); }
  #rightBtn { right: 0; transform: translateX(0); }
  .panelContent { padding: 20px; }
  table { width: 90%; margin: 20px auto; border-collapse: collapse; background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
  th, td { padding: 10px; border: 1px solid #ddd; text-align: left; }
  th { background: #4caf50; color: white; cursor: pointer; }
  tr:nth-child(even) { background: #f9f9f9; }
  tr:hover { background: #e0f7e9; }
  button { background: #4caf50; color: white; border: none; padding: 5px 10px; cursor: pointer; }
  button:hover { background: #45a049; }
  input, select { padding:5px; margin:3px; }
</style>
</head>
<body>
<header>
  <h1>ObowiƒÖzki domowe üè°</h1>
</header>

<div id="loginScreen">
  <h2>Wprowad≈∫ has≈Ço</h2>
  <input type="password" id="passwordInput" placeholder="Has≈Ço">
  <button id="loginBtn">Zaloguj</button>
  <p id="loginError" style="color:red;"></p>
</div>

<!-- Lewy panel -->
<div id="leftPanel" class="sidePanel">
  <div class="panelContent" id="leftContent">
    <h3>Filtry</h3>
    <input type="date" id="filterDate">
    <input type="text" id="filterName" placeholder="Filtruj po imieniu">
    <select id="filterTask">
      <option value="">Wszystkie obowiƒÖzki</option>
    </select>
    <button id="applyFilter">Filtruj</button>
    <button id="resetFilter">Resetuj filtr</button>
    <div id="adminOptions" style="margin-top:20px; display:none;">
      <h3>Admin</h3>
      <button id="clearAllBtn">Usu≈Ñ wszystkie wpisy</button>
      <button id="exportCSVBtn">Eksportuj CSV</button>
    </div>
  </div>
</div>
<button class="panelButton" id="leftBtn">&#9776;</button>

<!-- Prawy panel -->
<div id="rightPanel" class="sidePanel">
  <div class="panelContent" id="rightContent">
    <h3>Nowa lista (tylko admin)</h3>
    <input type="text" id="newListName" placeholder="Nazwa listy">
    <label><input type="checkbox" id="withDate"> Czy ma byƒá data?</label>
    <label><input type="checkbox" id="withCheckbox"> Czy ma byƒá checkbox?</label>
    <button id="createListBtn">Stw√≥rz listƒô</button>
    <h3>Wybierz listƒô</h3>
    <select id="listSelector"></select>
  </div>
</div>
<button class="panelButton" id="rightBtn">&#9881;</button>

<main id="mainContent" style="display:none;">
  <form id="taskForm">
    <input type="date" id="date">
    <input type="text" id="taskName" placeholder="Co zrobi≈Ç?" required>
    <input type="text" id="name" placeholder="Imiƒô" required>
    <button type="submit">Dodaj</button>
  </form>

  <table id="taskTable">
    <thead>
      <tr id="tableHead">
        <th>Data</th>
        <th>Co zrobi≈Ç</th>
        <th>Imiƒô</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</main>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyDeH4Ouu8XU09atWJMsawPrEsUCDTd8Pzo",
  authDomain: "obowiazki-domowe-b2312.firebaseapp.com",
  databaseURL: "https://obowiazki-domowe-b2312-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "obowiazki-domowe-b2312",
  storageBucket: "obowiazki-domowe-b2312.firebasestorage.app",
  messagingSenderId: "348397631566",
  appId: "1:348397631566:web:fef9f724dbf737b8cf6b1f"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
let currentList = "default";
let isAdmin = false;

// Logowanie
const loginScreen = document.getElementById("loginScreen");
const mainContent = document.getElementById("mainContent");
const loginBtn = document.getElementById("loginBtn");
const passwordInput = document.getElementById("passwordInput");
const loginError = document.getElementById("loginError");
const adminOptions = document.getElementById("adminOptions");

loginBtn.addEventListener("click", ()=>{
  const pass = passwordInput.value;
  if(pass === "admin123!"){
    isAdmin = true;
    adminOptions.style.display = "block";
  } else if(pass === "lista123!"){
    isAdmin = false;
  } else{
    loginError.textContent = "Nieprawid≈Çowe has≈Ço!";
    return;
  }
  loginScreen.style.display = "none";
  mainContent.style.display = "block";
  loadTasks();
  loadTaskSelect();
});

// Panele boczne
const leftPanel = document.getElementById("leftPanel");
const rightPanel = document.getElementById("rightPanel");
const leftBtn = document.getElementById("leftBtn");
const rightBtn = document.getElementById("rightBtn");
leftBtn.addEventListener("click",()=>{ leftPanel.style.transform = leftPanel.style.transform==="translateX(0px)"?"translateX(-100%)":"translateX(0px)"; });
rightBtn.addEventListener("click",()=>{ rightPanel.style.transform = rightPanel.style.transform==="translateX(0px)"?"translateX(100%)":"translateX(0px)"; });

// Tabela
const taskForm = document.getElementById("taskForm");
const tableBody = document.querySelector("#taskTable tbody");
const dateInput = document.getElementById("date");
const taskNameInput = document.getElementById("taskName");
const nameInput = document.getElementById("name");

taskForm.addEventListener("submit",(e)=>{
  e.preventDefault();
  const date = dateInput.value;
  const taskName = taskNameInput.value;
  const name = nameInput.value;
  if(!taskName || !name) return;
  db.ref("lists/"+currentList).push({date, taskName, name});
  taskForm.reset();
});

function loadTasks(){
  db.ref("lists/"+currentList).on("value", snapshot=>{
    tableBody.innerHTML="";
    snapshot.forEach(child=>{
      const data = child.val();
      const tr = document.createElement("tr");
      tr.innerHTML=`<td>${data.date||""}</td><td>${data.taskName}</td><td>${data.name}</td>`;
      tableBody.appendChild(tr);
    });
  });
}

// Admin tworzy listƒô
const newListName = document.getElementById("newListName");
const withDate = document.getElementById("withDate");
const withCheckbox = document.getElementById("withCheckbox");
const createListBtn = document.getElementById("createListBtn");
const listSelector = document.getElementById("listSelector");

createListBtn.addEventListener("click",()=>{
  if(!isAdmin) return;
  const name = newListName.value.trim();
  if(!name) return alert("Wpisz nazwƒô listy");
  db.ref("lists/"+name).set({info:{withDate:withDate.checked, withCheckbox:withCheckbox.checked}});
  newListName.value="";
  loadTaskSelect();
});

// Wyb√≥r listy
function loadTaskSelect(){
  listSelector.innerHTML="";
  db.ref("lists").get().then(snapshot=>{
    snapshot.forEach(child=>{
      const opt = document.createElement("option");
      opt.value = child.key;
      opt.textContent = child.key;
      listSelector.appendChild(opt);
    });
  });
}

listSelector.addEventListener("change",()=>{
  currentList = listSelector.value;
  loadTasks();
});
</script>
</body>
</html>