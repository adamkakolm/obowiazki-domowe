<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ObowiƒÖzki domowe - Panel</title>
<style>
  body { font-family: Arial, sans-serif; margin: 0; padding: 0; overflow-x: hidden; }
  header { background: #4caf50; color: white; padding: 20px; text-align: center; }
  #loginScreen { display: flex; flex-direction: column; justify-content: center; align-items: center; height: 80vh; }
  #loginScreen input, #loginScreen button { padding: 10px; margin: 5px; font-size: 16px; }
  #mainContent { display: none; position: relative; }
  /* Lewy panel */
  #leftPanel { position: fixed; top: 0; left: -250px; width: 250px; height: 100%; background: #2c3e50; color: white; transition: left 0.3s; padding: 20px; box-sizing: border-box; overflow-y: auto; z-index: 999; }
  #leftToggle { position: fixed; top: 50px; left: 0; background: #4caf50; color: white; padding: 10px; cursor: pointer; z-index: 1000; border-radius: 0 5px 5px 0; }
  /* Prawy panel */
  #rightPanel { position: fixed; top: 0; right: -250px; width: 250px; height: 100%; background: #34495e; color: white; transition: right 0.3s; padding: 20px; box-sizing: border-box; overflow-y: auto; z-index: 999; }
  #rightToggle { position: fixed; top: 50px; right: 0; background: #4caf50; color: white; padding: 10px; cursor: pointer; z-index: 1000; border-radius: 5px 0 0 5px; }
  main { margin: 20px; }
  form input, form select, form button { padding: 8px; margin: 5px; font-size: 14px; }
  button { background: #4caf50; color: white; border: none; cursor: pointer; }
  table { width: 90%; margin: 20px auto; border-collapse: collapse; background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
  th, td { padding: 10px; border: 1px solid #ddd; }
  th { background: #4caf50; color: white; }
  tr:nth-child(even) { background: #f9f9f9; }
  tr:hover { background: #e0f7e9; }
</style>
</head>
<body>
<header>
  <h1>ObowiƒÖzki domowe üè°</h1>
</header>

<div id="loginScreen">
  <input type="password" id="passwordInput" placeholder="Has≈Ço">
  <button id="loginBtn">Zaloguj</button>
  <p id="loginError" style="color:red;"></p>
</div>

<div id="mainContent">
  <!-- Lewy panel -->
  <div id="leftPanel">
    <h3>Filtry</h3>
    <input type="date" id="filterDate"><br>
    <input type="text" id="filterName" placeholder="Filtruj po imieniu"><br>
    <select id="filterTask">
      <option value="">Wszystkie obowiƒÖzki</option>
      <option value="odkurzanie">odkurzanie</option>
      <option value="zmywarka">zmywarka</option>
      <option value="zwierzaki">zwierzaki</option>
    </select><br>
    <button id="applyFilter">Filtruj</button>
    <button id="resetFilter">Resetuj filtr</button>

    <div id="adminOptions" style="margin-top:20px;">
      <h3>Panel admina</h3>
      <button id="clearAllBtn">Usu≈Ñ wszystkie wpisy</button><br>
      <input type="text" id="newTaskInput" placeholder="Nowy obowiƒÖzek"><br>
      <button id="addTaskBtn">Dodaj obowiƒÖzek</button>
    </div>
  </div>
  <div id="leftToggle">‚ò∞</div>

  <!-- Prawy panel -->
  <div id="rightPanel">
    <h3>Listy</h3>
    <div id="listContainer"></div>
    <input type="text" id="newListName" placeholder="Nowa lista"><br>
    <button id="createListBtn">Dodaj listƒô</button>
  </div>
  <div id="rightToggle">‚öôÔ∏è</div>

  <main>
    <form id="taskForm">
      <input type="date" id="date" required>
      <select id="taskType" required>
        <option value="" disabled selected>Wybierz obowiƒÖzek</option>
        <option value="odkurzanie">odkurzanie</option>
        <option value="zmywarka">zmywarka</option>
        <option value="zwierzaki">zwierzaki</option>
      </select>
      <input type="text" id="name" placeholder="Imiƒô" required>
      <button type="submit">Dodaj</button>
    </form>

    <table id="taskTable">
      <thead>
        <tr>
          <th>Data</th>
          <th>ObowiƒÖzek</th>
          <th>Imiƒô</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </main>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyDeH4Ouu8XU09atWJMsawPrEsUCDTd8Pzo",
  authDomain: "obowiazki-domowe-b2312.firebaseapp.com",
  databaseURL: "https://obowiazki-domowe-b2312-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "obowiazki-domowe-b2312",
  storageBucket: "obowiazki-domowe-b2312.firebasestorage.app",
  messagingSenderId: "348397631566",
  appId: "1:348397631566:web:fef9f724dbf737b8cf6b1f"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const tasksRef = db.ref("tasks");

// Logowanie
let isAdmin = false;
document.getElementById("loginBtn").addEventListener("click", ()=>{
  const pwd = document.getElementById("passwordInput").value;
  if(pwd==="admin123!"){ isAdmin=true; showMain(); }
  else if(pwd==="lista123!"){ isAdmin=false; showMain(); }
  else { document.getElementById("loginError").textContent="Nieprawid≈Çowe has≈Ço!"; }
});
function showMain(){
  document.getElementById("loginScreen").style.display="none";
  document.getElementById("mainContent").style.display="block";
  if(!isAdmin) document.getElementById("adminOptions").style.display="none";
  loadTable();
}

// Panele boczne
const leftPanel=document.getElementById("leftPanel");
const leftToggle=document.getElementById("leftToggle");
const rightPanel=document.getElementById("rightPanel");
const rightToggle=document.getElementById("rightToggle");

leftToggle.addEventListener("click",()=>{
  if(leftPanel.style.left==="0px"){ leftPanel.style.left="-250px"; leftToggle.style.left="0px"; }
  else{ leftPanel.style.left="0px"; leftToggle.style.left="250px"; }
});
rightToggle.addEventListener("click",()=>{
  if(rightPanel.style.right==="0px"){ rightPanel.style.right="-250px"; rightToggle.style.right="0px"; }
  else{ rightPanel.style.right="0px"; rightToggle.style.right="250px"; }
});

// Formularz dodawania wpisu
document.getElementById("taskForm").addEventListener("submit",e=>{
  e.preventDefault();
  const date=document.getElementById("date").value;
  const task=document.getElementById("taskType").value;
  const name=document.getElementById("name").value;
  if(!date||!task||!name) return;
  tasksRef.push({date,task,name});
  e.target.reset();
});

// Admin dodawanie obowiƒÖzku
document.getElementById("addTaskBtn").addEventListener("click",()=>{
  const newTask=document.getElementById("newTaskInput").value.trim();
  if(newTask){ const select=document.getElementById("taskType");
    const option=document.createElement("option");
    option.value=newTask; option.textContent=newTask; select.appendChild(option);
    document.getElementById("newTaskInput").value=""; } 
});

// Admin usu≈Ñ wszystkie
document.getElementById("clearAllBtn").addEventListener("click",()=>{ if(confirm("Na pewno chcesz usunƒÖƒá wszystkie wpisy?")) tasksRef.remove(); });

// Tworzenie nowych list
document.getElementById("createListBtn").addEventListener("click",()=>{
  if(!isAdmin) return;
  const listName=document.getElementById("newListName").value.trim();
  if(listName){
    const div=document.createElement("div"); div.textContent=listName;
    document.getElementById("listContainer").appendChild(div);
    document.getElementById("newListName").value="";
  }
});

// ≈Åadowanie tabeli
function loadTable(){
  tasksRef.on("value",snapshot=>{
    const tbody=document.querySelector("#taskTable tbody");
    tbody.innerHTML="";
    snapshot.forEach(child=>{
      const data=child.val();
      const tr=document.createElement("tr");
      tr.innerHTML=`<td>${data.date}</td><td>${data.task}</td><td>${data.name}</td>`;
      if(isAdmin){
        const td=document.createElement("td");
        const btn=document.createElement("button");
        btn.textContent="Usu≈Ñ";
        btn.addEventListener("click",()=>tasksRef.child(child.key).remove());
        td.appendChild(btn); tr.appendChild(td);
      }
      tbody.appendChild(tr);
    });
  });
}

// Filtry
document.getElementById("applyFilter").addEventListener("click",()=>{
  const dateF=document.getElementById("filterDate").value;
  const nameF=document.getElementById("filterName").value.toLowerCase();
  const taskF=document.getElementById("filterTask").value;
  tasksRef.get().then(snapshot=>{
    const tbody=document.querySelector("#taskTable tbody"); tbody.innerHTML="";
    snapshot.forEach(child=>{
      const data=child.val(); let show=true;
      if(dateF && data.date!==dateF) show=false;
      if(nameF && !data.name.toLowerCase().includes(nameF)) show=false;
      if(taskF && data.task!==taskF) show=false;
      if(show){
        const tr=document.createElement("tr");
        tr.innerHTML=`<td>${data.date}</td><td>${data.task}</td><td>${data.name}</td>`;
        if(isAdmin){
          const td=document.createElement("td");
          const btn=document.createElement("button"); btn.textContent="Usu≈Ñ";
          btn.addEventListener("click",()=>tasksRef.child(child.key).remove());
          td.appendChild(btn); tr.appendChild(td);
        }
        tbody.appendChild(tr);
      }
    });
  });
});
document.getElementById("resetFilter").addEventListener("click",()=>{
  document.getElementById("filterDate").value="";
  document.getElementById("filterName").value="";
  document.getElementById("filterTask").value="";
  loadTable();
});
</script>
</body>
</html>