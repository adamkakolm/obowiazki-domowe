<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ObowiƒÖzki domowe</title>
<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 0;
}

/* Header */
header {
  background: #4caf50;
  color: white;
  padding: 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* Hamburger i zƒôbatka */
#menuBtn, #filterBtn {
  font-size: 24px;
  cursor: pointer;
}

/* Lewy panel */
#leftPanel {
  position: fixed;
  top: 0;
  left: -250px;
  width: 250px;
  height: 100%;
  background: #333;
  color: white;
  padding: 20px;
  transition: left 0.3s;
  overflow-y: auto;
  z-index: 1000;
}
#leftPanel a {
  display: block;
  color: white;
  text-decoration: none;
  margin: 10px 0;
}
#leftPanel a:hover { text-decoration: underline; }

/* Prawy panel */
#rightPanel {
  position: fixed;
  top: 0;
  right: -300px;
  width: 300px;
  height: 100%;
  background: #444;
  color: white;
  padding: 20px;
  transition: right 0.3s;
  overflow-y: auto;
  z-index: 1000;
}
#rightPanel input, #rightPanel select, #rightPanel button {
  width: 100%;
  margin-bottom: 10px;
  padding: 8px;
}

/* Login */
#loginScreen {
  text-align: center;
  padding: 50px;
}

/* Main content */
#mainContent {
  padding: 20px;
  display: none;
  transition: margin 0.3s;
}

/* Table */
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}
th, td {
  padding: 10px;
  border: 1px solid #ddd;
  text-align:center;
}
th { background: #4caf50; color:white; cursor:pointer; }
tr:nth-child(even){ background:#f9f9f9; }
tr:hover { background:#e0f7e9; }

/* Buttons */
button { background:#4caf50; color:white; border:none; cursor:pointer; }
button:hover { background:#45a049; }
</style>
</head>
<body>
<header>
  <div id="menuBtn">&#9776;</div>
  <h1>ObowiƒÖzki domowe üè°</h1>
  <div id="filterBtn">&#9881;</div>
</header>

<!-- Lewy panel -->
<div id="leftPanel">
  <h3>Menu</h3>
  <a href="#">Strona g≈Ç√≥wna</a>
  <a href="#">ObowiƒÖzki domowe</a>
  <a href="#">Kontakt</a>
</div>

<!-- Prawy panel -->
<div id="rightPanel">
  <h3>Filtry</h3>
  <input type="date" id="filterDate">
  <input type="text" id="filterName" placeholder="Filtruj po imieniu">
  <select id="filterTask">
    <option value="">Wszystkie obowiƒÖzki</option>
    <option value="odkurzanie">odkurzanie</option>
    <option value="zmywarka">zmywarka</option>
    <option value="zwierzaki">zwierzaki</option>
  </select>
  <button id="applyFilter">Filtruj</button>
  <button id="resetFilter">Resetuj filtr</button>
</div>

<!-- Login -->
<div id="loginScreen">
  <h2>Wprowad≈∫ has≈Ço, aby wej≈õƒá</h2>
  <input type="password" id="passwordInput" placeholder="Has≈Ço">
  <button id="loginBtn">Zaloguj</button>
  <p id="loginError" style="color:red;"></p>
</div>

<!-- Main content -->
<div id="mainContent">
<form id="taskForm">
<input type="date" id="date" required>
<select id="taskType" required>
<option value="" disabled selected>Wybierz obowiƒÖzek</option>
<option value="odkurzanie">odkurzanie</option>
<option value="zmywarka">zmywarka</option>
<option value="zwierzaki">zwierzaki</option>
</select>
<input type="text" id="name" placeholder="Imiƒô" required>
<button type="submit">Dodaj</button>
</form>

<div id="adminPanel" style="display:none;">
<button id="clearAllBtn">Usu≈Ñ wszystkie wpisy</button>
<button id="exportCSVBtn">Eksportuj CSV</button>
<input type="text" id="newTaskInput" placeholder="Nowy obowiƒÖzek">
<button id="addTaskBtn">Dodaj obowiƒÖzek</button>
</div>

<table id="taskTable">
<thead>
<tr>
<th>Data</th>
<th>Co zrobi≈Ç</th>
<th>Imiƒô</th>
<th>Akcje</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
// Firebase
const firebaseConfig = {
  apiKey: "AIzaSyDeH4Ouu8XU09atWJMsawPrEsUCDTd8Pzo",
  authDomain: "obowiazki-domowe-b2312.firebaseapp.com",
  databaseURL: "https://obowiazki-domowe-b2312-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "obowiazki-domowe-b2312",
  storageBucket: "obowiazki-domowe-b2312.firebasestorage.app",
  messagingSenderId: "348397631566",
  appId: "1:348397631566:web:fef9f724dbf737b8cf6b1f"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const tasksRef = db.ref("tasks");

// Logowanie
const loginScreen = document.getElementById("loginScreen");
const mainContent = document.getElementById("mainContent");
const loginBtn = document.getElementById("loginBtn");
const passwordInput = document.getElementById("passwordInput");
const loginError = document.getElementById("loginError");
const adminPanel = document.getElementById("adminPanel");
const tableBody = document.querySelector("#taskTable tbody");

let isAdmin = false;

loginBtn.addEventListener("click", () => {
  const pass = passwordInput.value;
  if(pass==="admin123!"){
    isAdmin = true;
    loginScreen.style.display="none";
    mainContent.style.display="block";
    adminPanel.style.display="block";
    loadTable();
  }else if(pass==="lista123!"){
    isAdmin = false;
    loginScreen.style.display="none";
    mainContent.style.display="block";
    loadTable();
  }else{
    loginError.textContent="Nieprawid≈Çowe has≈Ço!";
    passwordInput.value="";
  }
});

// Lewy i prawy panel
const menuBtn = document.getElementById("menuBtn");
const leftPanel = document.getElementById("leftPanel");
const filterBtn = document.getElementById("filterBtn");
const rightPanel = document.getElementById("rightPanel");

menuBtn.addEventListener("click", () => {
  leftPanel.style.left = leftPanel.style.left==="0px"?"-250px":"0px";
});
filterBtn.addEventListener("click", () => {
  rightPanel.style.right = rightPanel.style.right==="0px"?"-300px":"0px";
});

// Formularz dodawania
const form = document.getElementById("taskForm");
form.addEventListener("submit", (e)=>{
  e.preventDefault();
  const date=document.getElementById("date").value;
  const task=document.getElementById("taskType").value;
  const name=document.getElementById("name").value.trim();
  if(!date||!task||!name){alert("Wype≈Çnij wszystkie pola"); return;}
  tasksRef.push({date, task, name});
  form.reset();
});

// Funkcja do wczytania tabeli
function loadTable(){
  tasksRef.on("value", snapshot=>{
    tableBody.innerHTML="";
    const thead = document.querySelector("#taskTable thead tr");
    if(isAdmin && !thead.querySelector(".actionsHeader")){
      const th=document.createElement("th");
      th.textContent="Akcje"; th.classList.add("actionsHeader");
      thead.appendChild(th);
    }
    snapshot.forEach(child=>{
      const data = child.val();
      const row=document.createElement("tr");
      row.innerHTML=`
        <td>${data.date}</td>
        <td>${data.task}</td>
        <td>${data.name}</td>
        ${isAdmin?'<td><button class="deleteBtn">Usu≈Ñ</button></td>':""}
      `;
      tableBody.appendChild(row);
      if(isAdmin){
        row.querySelector(".deleteBtn").addEventListener("click", ()=>{tasksRef.child(child.key).remove();});
      }
    });
  });
}

// Admin funkcje
document.getElementById("clearAllBtn").addEventListener("click", ()=>{
  if(confirm("Na pewno chcesz usunƒÖƒá wszystkie wpisy?")) tasksRef.remove();
});
document.getElementById("exportCSVBtn").addEventListener("click", ()=>{
  tasksRef.get().then(snapshot=>{
    let csv="Data,ObowiƒÖzek,Imiƒô\n";
    snapshot.forEach(child=>{
      const data = child.val();
      csv+=`${data.date},${data.task},${data.name}\n`;
    });
    const blob=new Blob([csv],{type:'text/csv'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');
    a.href=url; a.download='obowiazki.csv'; a.click();
    URL.revokeObjectURL(url);
  });
});
</script>
</body>
</html>
