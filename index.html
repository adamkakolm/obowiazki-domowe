<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dynamiczne listy - ObowiƒÖzki domowe</title>
<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f3f3f3;}
header { background:#4caf50; color:white; padding:20px; text-align:center;}
#loginScreen {display:flex; flex-direction:column; align-items:center; justify-content:center; height:80vh;}
#mainContent {display:none; padding:20px; position:relative;}
#leftPanel, #rightPanel {
    position: fixed; top:0; bottom:0; width:250px; background:#2c3e50; color:white; overflow:auto;
    transition: transform 0.3s ease;
}
#leftPanel { left:0; transform: translateX(-220px); }
#rightPanel { right:0; transform: translateX(220px); }
.panelButton { position:fixed; top:50px; width:30px; height:30px; background:#4caf50; color:white; border:none; cursor:pointer; z-index:10; }
#leftBtn { left:0; transform:translateX(0);}
#rightBtn { right:0; transform:translateX(0);}
#taskTable { width:90%; margin:0 auto; border-collapse:collapse; background:white; box-shadow:0 2px 5px rgba(0,0,0,0.1);}
th,td{padding:10px;border:1px solid #ddd;}
th{background:#4caf50;color:white;}
tr:nth-child(even){background:#f9f9f9;}
tr:hover{background:#e0f7e9;}
input, select, button { padding:5px; margin:5px;}
</style>
</head>
<body>

<header>
<h1>ObowiƒÖzki domowe üè°</h1>
</header>

<div id="loginScreen">
<h2>Wprowad≈∫ has≈Ço</h2>
<input type="password" id="passwordInput" placeholder="Has≈Ço">
<button id="loginBtn">Zaloguj</button>
<p id="loginError" style="color:red;"></p>
</div>

<div id="mainContent">

<button id="leftBtn" class="panelButton">&#9776;</button>
<button id="rightBtn" class="panelButton">&#9881;</button>

<div id="leftPanel">
<h3>Panel admina</h3>
<div id="adminSection">
<h4>Tworzenie nowej listy</h4>
<input type="text" id="newListName" placeholder="Nazwa listy"><br>
<label><input type="checkbox" id="hasDate"> Z datƒÖ</label><br>
<label><input type="checkbox" id="hasCheckbox"> Z checkbox</label><br>
<button id="createListBtn">Utw√≥rz listƒô</button>
<hr>
<h4>Dodaj obowiƒÖzek do listy</h4>
<select id="selectListForTask"></select><br>
<input type="text" id="newTaskInput" placeholder="ObowiƒÖzek/tekst">
<button id="addTaskBtn">Dodaj obowiƒÖzek</button>
<hr>
<h4>Filtry</h4>
<input type="date" id="filterDate">
<input type="text" id="filterName" placeholder="Filtruj po imieniu">
<select id="filterTask"></select>
<button id="applyFilter">Filtruj</button>
<button id="resetFilter">Resetuj filtr</button>
<hr>
<button id="clearAllBtn">Usu≈Ñ wszystkie wpisy</button>
</div>
</div>

<div id="rightPanel">
<h3>Wybierz listƒô</h3>
<select id="selectList"></select>
</div>

<table id="taskTable">
<thead></thead>
<tbody></tbody>
</table>

</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<script>
// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyDeH4Ouu8XU09atWJMsawPrEsUCDTd8Pzo",
  authDomain: "obowiazki-domowe-b2312.firebaseapp.com",
  databaseURL: "https://obowiazki-domowe-b2312-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "obowiazki-domowe-b2312",
  storageBucket: "obowiazki-domowe-b2312.firebasestorage.app",
  messagingSenderId: "348397631566",
  appId: "1:348397631566:web:fef9f724dbf737b8cf6b1f"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let isAdmin=false;
let currentList="default";

// Logowanie
const loginScreen=document.getElementById("loginScreen");
const mainContent=document.getElementById("mainContent");
const loginBtn=document.getElementById("loginBtn");
const passwordInput=document.getElementById("passwordInput");
const loginError=document.getElementById("loginError");

loginBtn.addEventListener("click",()=>{
    const pass=passwordInput.value;
    if(pass==="admin123!"){
        isAdmin=true;
        loginScreen.style.display="none";
        mainContent.style.display="block";
        loadLists();
    }else if(pass==="lista123!"){
        isAdmin=false;
        loginScreen.style.display="none";
        mainContent.style.display="block";
        loadLists();
    }else{
        loginError.textContent="Nieprawid≈Çowe has≈Ço!";
        passwordInput.value="";
    }
});

// Panele boczne
const leftPanel=document.getElementById("leftPanel");
const rightPanel=document.getElementById("rightPanel");
const leftBtn=document.getElementById("leftBtn");
const rightBtn=document.getElementById("rightBtn");

leftBtn.addEventListener("click",()=>{
    if(leftPanel.style.transform==="translateX(0px)") leftPanel.style.transform="translateX(-220px)";
    else leftPanel.style.transform="translateX(0px)";
});
rightBtn.addEventListener("click",()=>{
    if(rightPanel.style.transform==="translateX(0px)") rightPanel.style.transform="translateX(220px)";
    else rightPanel.style.transform="translateX(0px)";
});

// Tworzenie list
const createListBtn=document.getElementById("createListBtn");
const newListName=document.getElementById("newListName");
const hasDate=document.getElementById("hasDate");
const hasCheckbox=document.getElementById("hasCheckbox");

createListBtn.addEventListener("click",()=>{
    const name=newListName.value.trim();
    if(!name) return alert("Wpisz nazwƒô listy");
    db.ref("lists/"+name).set({
        name:name,
        date:hasDate.checked,
        checkbox:hasCheckbox.checked,
        columns:["tekst"]
    });
    newListName.value="";
    hasDate.checked=false;
    hasCheckbox.checked=false;
    loadLists();
});

// Dodawanie wpis√≥w
const selectListForTask=document.getElementById("selectListForTask");
const newTaskInput=document.getElementById("newTaskInput");
const addTaskBtn=document.getElementById("addTaskBtn");

addTaskBtn.addEventListener("click",()=>{
    const listName=selectListForTask.value;
    if(!listName) return alert("Wybierz listƒô");
    const text=newTaskInput.value.trim();
    if(!text) return alert("Wpisz warto≈õƒá");
    db.ref("tasks/"+listName).push({tekst:text, date:null, checkbox:false});
    newTaskInput.value="";
});

// Wyb√≥r listy
const selectList=document.getElementById("selectList");
selectList.addEventListener("change",()=>{
    currentList=selectList.value;
    loadTable();
});

// Filtry
const filterDate=document.getElementById("filterDate");
const filterName=document.getElementById("filterName");
const filterTask=document.getElementById("filterTask");
document.getElementById("applyFilter").addEventListener("click",loadTable);
document.getElementById("resetFilter").addEventListener("click",()=>{
    filterDate.value=""; filterName.value=""; filterTask.value="";
    loadTable();
});

// Usu≈Ñ wszystkie
document.getElementById("clearAllBtn").addEventListener("click",()=>{
    if(confirm("Na pewno usunƒÖƒá wszystkie wpisy?")){
        db.ref("tasks/"+currentList).remove();
    }
});

// Wczytywanie list
function loadLists(){
    db.ref("lists").get().then(snapshot=>{
        selectList.innerHTML=""; selectListForTask.innerHTML="";
        snapshot.forEach(child=>{
            const l=child.val();
            const option=document.createElement("option");
            option.value=l.name; option.textContent=l.name;
            selectList.appendChild(option);
            if(isAdmin) selectListForTask.appendChild(option.cloneNode(true));
        });
        currentList=selectList.value||currentList;
        loadTable();
    });
}

// Tabela dynamiczna
const tableBody=document.querySelector("#taskTable tbody");
function loadTable(){
    if(!currentList) return;
    db.ref("tasks/"+currentList).get().then(snapshot=>{
        tableBody.innerHTML="";
        snapshot.forEach(child=>{
            const data=child.val();
            const row=document.createElement("tr");
            let html="";
            if(data.date!==undefined && data.date!==null) html+=`<td>${data.date||""}</td>`;
            html+=`<td>${data.tekst||""}</td>`;
            if(data.checkbox!==undefined) html+=`<td><input type="checkbox" ${data.checkbox?"checked":""} disabled></td>`;
            tableBody.appendChild(row);
            row.innerHTML=html;
            if(isAdmin){
                const del=document.createElement("button");
                del.textContent="Usu≈Ñ";
                del.addEventListener("click",()=>{db.ref("tasks/"+currentList+"/"+child.key).remove();});
                const td=document.createElement("td");
                td.appendChild(del);
                row.appendChild(td);
            }
        });
    });
}
</script>

</body>
</html>