<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ObowiƒÖzki domowe</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f3f3f3;
    margin: 0;
    padding: 0;
  }
  #loginScreen {
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    height:100vh;
    text-align:center;
  }
  input, button, select {
    padding:10px;
    margin:5px;
    font-size:14px;
  }
  button {
    background:#4caf50;
    color:white;
    border:none;
    cursor:pointer;
  }
  button:hover{background:#45a049;}
  header{
    background:#4caf50;
    color:white;
    padding:20px;
    text-align:center;
  }
  #mainContent{
    display:none;
    position:relative;
  }
  /* Boczne panele */
  .sidePanel{
    position:fixed;
    top:0;
    width:300px;
    height:100%;
    background:white;
    box-shadow:2px 0 5px rgba(0,0,0,0.2);
    overflow:auto;
    transition: transform 0.3s;
    z-index:1000;
  }
  #leftPanel{
    left:0;
    transform:translateX(-100%);
  }
  #rightPanel{
    right:0;
    transform:translateX(100%);
  }
  .toggleBtn{
    position:fixed;
    top:20px;
    width:40px;
    height:40px;
    background:#4caf50;
    color:white;
    border:none;
    cursor:pointer;
    z-index:1100;
  }
  #leftToggle{left:0;}
  #rightToggle{right:0;}
  table{
    width:90%;
    margin:20px auto;
    border-collapse:collapse;
    background:white;
  }
  th, td{
    padding:10px;
    border:1px solid #ddd;
    text-align:center;
  }
  th{background:#4caf50; color:white;}
  tr:nth-child(even){background:#f9f9f9;}
  tr:hover{background:#e0f7e9;}
  form{margin:20px;}
</style>
</head>
<body>
<header>
  <h1>ObowiƒÖzki domowe üè°</h1>
</header>

<div id="loginScreen">
  <h2>Wprowad≈∫ has≈Ço, aby wej≈õƒá</h2>
  <input type="password" id="passwordInput" placeholder="Has≈Ço">
  <button id="loginBtn">Zaloguj</button>
  <p id="loginError" style="color:red;"></p>
</div>

<div id="mainContent">
  <!-- Przyciski do wysuwania paneli -->
  <button class="toggleBtn" id="leftToggle">‚ò∞</button>
  <button class="toggleBtn" id="rightToggle">‚öô</button>

  <!-- Lewy panel (przyk≈Çadowo przysz≈Çe listy) -->
  <div id="leftPanel" class="sidePanel">
    <h3>Panel lewy</h3>
    <p>Tu w przysz≈Ço≈õci pojawiƒÖ siƒô inne listy.</p>
  </div>

  <!-- Prawy panel (filtry + admin) -->
  <div id="rightPanel" class="sidePanel">
    <h3>Filtry</h3>
    <input type="date" id="filterDate">
    <input type="text" id="filterName" placeholder="Filtruj po imieniu">
    <select id="filterTask">
      <option value="">Wszystkie obowiƒÖzki</option>
      <option value="odkurzanie">odkurzanie</option>
      <option value="zmywarka">zmywarka</option>
      <option value="zwierzaki">zwierzaki</option>
    </select>
    <button id="applyFilter">Filtruj</button>
    <button id="resetFilter">Resetuj filtr</button>

    <div id="adminPanel" style="display:none; margin-top:20px;">
      <h3>Panel Admina</h3>
      <button id="clearAllBtn">Usu≈Ñ wszystkie wpisy</button>
      <button id="exportCSVBtn">Eksportuj CSV</button>
      <input type="text" id="newTaskInput" placeholder="Nowy obowiƒÖzek">
      <button id="addTaskBtn">Dodaj obowiƒÖzek</button>
    </div>
  </div>

  <!-- Formularz dodawania wpis√≥w -->
  <form id="taskForm">
    <input type="date" id="date" required>
    <select id="taskType" required>
      <option value="" disabled selected>Wybierz obowiƒÖzek</option>
      <option value="odkurzanie">odkurzanie</option>
      <option value="zmywarka">zmywarka</option>
      <option value="zwierzaki">zwierzaki</option>
    </select>
    <input type="text" id="name" placeholder="Imiƒô" required>
    <button type="submit">Dodaj</button>
  </form>

  <!-- Tabela -->
  <table id="taskTable">
    <thead>
      <tr>
        <th>Data</th>
        <th>Co zrobi≈Ç</th>
        <th>Imiƒô</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "TW√ìJ_API_KEY",
  authDomain: "TW√ìJ_AUTH_DOMAIN",
  databaseURL: "TW√ìJ_DB_URL",
  projectId: "TW√ìJ_PROJECT_ID",
  storageBucket: "TW√ìJ_STORAGE",
  messagingSenderId: "TW√ìJ_SENDER",
  appId: "TW√ìJ_APP_ID"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const tasksRef = db.ref("tasks");

// Logowanie
const loginScreen = document.getElementById("loginScreen");
const mainContent = document.getElementById("mainContent");
const loginBtn = document.getElementById("loginBtn");
const passwordInput = document.getElementById("passwordInput");
const loginError = document.getElementById("loginError");
const adminPanel = document.getElementById("adminPanel");
let isAdmin = false;

loginBtn.addEventListener("click", () => {
  const pwd = passwordInput.value.trim();
  if(pwd === "admin123!"){
    isAdmin = true;
    adminPanel.style.display="block";
    loginScreen.style.display="none";
    mainContent.style.display="block";
    loadTable();
  } else if(pwd === "lista123!"){
    isAdmin = false;
    adminPanel.style.display="none";
    loginScreen.style.display="none";
    mainContent.style.display="block";
    loadTable();
  } else{
    loginError.textContent="Nieprawid≈Çowe has≈Ço!";
    passwordInput.value="";
  }
});

// Toggle panele
const leftPanel = document.getElementById("leftPanel");
const rightPanel = document.getElementById("rightPanel");
document.getElementById("leftToggle").addEventListener("click",()=>{
  if(leftPanel.style.transform=="translateX(0%)"){
    leftPanel.style.transform="translateX(-100%)";
  }else{
    leftPanel.style.transform="translateX(0%)";
  }
});
document.getElementById("rightToggle").addEventListener("click",()=>{
  if(rightPanel.style.transform=="translateX(0%)"){
    rightPanel.style.transform="translateX(100%)";
  }else{
    rightPanel.style.transform="translateX(0%)";
  }
});

// Formularz dodawania
const form = document.getElementById("taskForm");
const tableBody = document.querySelector("#taskTable tbody");
form.addEventListener("submit", e=>{
  e.preventDefault();
  const date=document.getElementById("date").value;
  const task=document.getElementById("taskType").value;
  const name=document.getElementById("name").value.trim();
  if(!date || !task || !name){alert("Wype≈Çnij wszystkie pola"); return;}
  tasksRef.push({date,task,name});
  form.reset();
});

// Wczytanie tabeli
function loadTable(){
  tasksRef.on("value",snapshot=>{
    tableBody.innerHTML="";
    const thead=document.querySelector("#taskTable thead tr");
    if(isAdmin && !thead.querySelector(".actionsHeader")){
      const th=document.createElement("th");
      th.textContent="Akcje"; th.classList.add("actionsHeader"); thead.appendChild(th);
    }
    snapshot.forEach(child=>{
      const data=child.val();
      const row=document.createElement("tr");
      row.innerHTML=`<td>${data.date}</td><td>${data.task}</td><td>${data.name}</td>${isAdmin?'<td><button class="deleteBtn">Usu≈Ñ</button></td>':''}`;
      tableBody.appendChild(row);
      if(isAdmin){
        row.querySelector(".deleteBtn").addEventListener("click",()=>{tasksRef.child(child.key).remove();});
      }
    });
  });
}

// Admin - usu≈Ñ wszystkie
document.getElementById("clearAllBtn").addEventListener("click",()=>{
  if(confirm("Na pewno chcesz usunƒÖƒá wszystkie wpisy?")){
    tasksRef.remove();
  }
});

// Admin - eksport CSV
document.getElementById("exportCSVBtn").addEventListener("click",()=>{
  tasksRef.get().then(snapshot=>{
    let csv="Data,ObowiƒÖzek,Imiƒô\n";
    snapshot.forEach(child=>{
      const data=child.val();
      csv+=`${data.date},${data.task},${data.name}\n`;
    });
    const blob=new Blob([csv],{type:'text/csv'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');
    a.href=url;
    a.download='obowiazki.csv';
    a.click();
    URL.revokeObjectURL(url);
  });
});

// Admin - dodawanie nowego obowiƒÖzku
document.getElementById("addTaskBtn").addEventListener("click",()=>{
  const newTask=document.getElementById("newTaskInput").value.trim();
  if(newTask){
    const select=document.getElementById("taskType");
    const filterSelect=document.getElementById("filterTask");
    const option=document.createElement("option"); option.value=newTask; option.textContent=newTask; select.appendChild(option);
    const filterOption=document.createElement("option"); filterOption.value=newTask; filterOption.textContent=newTask; filterSelect.appendChild(filterOption);
    document.getElementById("newTaskInput").value="";
    alert("Nowy obowiƒÖzek dodany!");
  } else{alert("Wpisz nazwƒô obowiƒÖzku");}
});

// Filtry
document.getElementById("applyFilter").addEventListener("click",()=>{
  const dateF=document.getElementById("filterDate").value;
  const nameF=document.getElementById("filterName").value.toLowerCase();
  const taskF=document.getElementById("filterTask").value;
  tasksRef.get().then(snapshot=>{
    tableBody.innerHTML="";
    snapshot.forEach(child=>{
      const data=child.val(); let show=true;
      if(dateF && data.date!==dateF) show=false;
      if(nameF && !data.name.toLowerCase().includes(nameF)) show=false;
      if(taskF && data.task!==taskF) show=false;
      if(show){
        const row=document.createElement("tr");
        row.innerHTML=`<td>${data.date}</td><td>${data.task}</td><td>${data.name}</td>${isAdmin?'<td><button class="deleteBtn">Usu≈Ñ</button></td>':''}`;
        tableBody.appendChild(row);
        if(isAdmin){
          row.querySelector(".deleteBtn").addEventListener("click",()=>{tasksRef.child(child.key).remove();});
        }
      }
    });
  });
});

// Reset filtr√≥w
document.getElementById("resetFilter").addEventListener("click",()=>{
  document.getElementById("filterDate").value="";
  document.getElementById("filterName").value="";
  document.getElementById("filterTask").value="";
  loadTable();
});
</script>
</body>
</html>