<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ObowiƒÖzki domowe - Admin</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f3f3f3;
      margin: 0;
      padding: 0;
      text-align: center;
    }
    header {
      background: #4caf50;
      color: white;
      padding: 20px;
    }
    main, #mainContent { padding: 20px; }
    form { margin-bottom: 20px; }
    form input, form button, form select {
      padding: 10px;
      margin: 5px;
      font-size: 14px;
    }
    form select { width: 200px; }
    button {
      background: #4caf50;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover { background: #45a049; }
    table {
      width: 90%;
      margin: 0 auto;
      border-collapse: collapse;
      background: white;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    th, td {
      padding: 10px;
      border: 1px solid #ddd;
    }
    th {
      background: #4caf50;
      color: white;
    }
    tr:nth-child(even) { background: #f9f9f9; }
    tr:hover { background: #e0f7e9; }
  </style>
</head>
<body>
  <header>
    <h1>ObowiƒÖzki domowe üè°</h1>
  </header>

  <!-- Ekran logowania -->
  <div id="loginScreen">
    <h2>Wprowad≈∫ has≈Ço, aby wej≈õƒá</h2>
    <input type="password" id="passwordInput" placeholder="Has≈Ço">
    <button id="loginBtn">Zaloguj</button>
    <p id="loginError" style="color:red;"></p>
  </div>

  <!-- G≈Ç√≥wna zawarto≈õƒá (formularz i tabela) -->
  <div id="mainContent" style="display:none;">
    <form id="taskForm">
      <input type="date" id="date" required>
      <select id="taskType" required>
        <option value="" disabled selected>Wybierz obowiƒÖzek</option>
        <option value="odkurzanie">odkurzanie</option>
        <option value="zmywarka">zmywarka</option>
        <option value="zwierzaki">zwierzaki</option>
      </select>
      <input type="text" id="name" placeholder="Imiƒô" required>
      <button type="submit">Dodaj</button>
    </form>

    <table id="taskTable">
      <thead>
        <tr>
          <th>Data</th>
          <th>Co zrobi≈Ç</th>
          <th>Imiƒô</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <script>
    // Konfiguracja Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyDeH4Ouu8XU09atWJMsawPrEsUCDTd8Pzo",
      authDomain: "obowiazki-domowe-b2312.firebaseapp.com",
      databaseURL: "https://obowiazki-domowe-b2312-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "obowiazki-domowe-b2312",
      storageBucket: "obowiazki-domowe-b2312.firebasestorage.app",
      messagingSenderId: "348397631566",
      appId: "1:348397631566:web:fef9f724dbf737b8cf6b1f"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const tasksRef = db.ref("tasks");

    // Logowanie
    const loginScreen = document.getElementById("loginScreen");
    const mainContent = document.getElementById("mainContent");
    const loginBtn = document.getElementById("loginBtn");
    const passwordInput = document.getElementById("passwordInput");
    const loginError = document.getElementById("loginError");

    let isAdmin = false;

   loginBtn.addEventListener("click", () => {
  const userPassword = passwordInput.value;

  if(userPassword === "admin123!" || userPassword === "lista123!") {
    isAdmin = (userPassword === "admin123!");
    loginScreen.style.display = "none";
    mainContent.style.display = "block";

    // Teraz wczytujemy tabelƒô ‚Äì po zalogowaniu
    loadTable();
  } else {
    loginError.textContent = "Nieprawid≈Çowe has≈Ço!";
    passwordInput.value = "";
  }
});


    // Formularz i tabela
    const form = document.getElementById("taskForm");
    const tableBody = document.querySelector("#taskTable tbody");

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const date = document.getElementById("date").value;
      const task = document.getElementById("taskType").value;
      const name = document.getElementById("name").value.trim();

      if(!date || !task || !name){
        alert("Wype≈Çnij wszystkie pola");
        return;
      }

      tasksRef.push({ date, task, name });
      form.reset();
    });

    // Wy≈õwietlanie tabeli
   function loadTable() {
  tasksRef.on("value", (snapshot) => {
    tableBody.innerHTML = "";

    // Nag≈Ç√≥wek "Akcje" dla admina
    const thead = document.querySelector("#taskTable thead tr");
    if(isAdmin && !thead.querySelector(".actionsHeader")){
      const th = document.createElement("th");
      th.textContent = "Akcje";
      th.classList.add("actionsHeader");
      thead.appendChild(th);
    }

    snapshot.forEach((child) => {
      const data = child.val();
      const row = document.createElement("tr");

      row.innerHTML = `
        <td>${data.date}</td>
        <td>${data.task}</td>
        <td>${data.name}</td>
        ${isAdmin ? `<td><button class="deleteBtn">Usu≈Ñ</button></td>` : ""}
      `;
      tableBody.appendChild(row);

      // Usu≈Ñ tylko dla admina
      if(isAdmin){
        const deleteBtn = row.querySelector(".deleteBtn");
        deleteBtn.addEventListener("click", () => {
          tasksRef.child(child.key).remove();
        });
      }
    });
  });
}

  </script>
</body>
</html>

